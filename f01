  "---------------------------------------------------
  " Step 5: Filter strictly by input range (date + time)
  "---------------------------------------------------
  DATA(lv_recent_ts) TYPE char14.
  DATA(lv_input_ts)  TYPE char14.

  CONCATENATE lv_recent_date lv_recent_time INTO lv_recent_ts.
  CONCATENATE so_date-low   so_time-low   INTO lv_input_ts.

  IF lv_recent_ts < lv_input_ts.
    RETURN.
  ENDIF.