REPORT zin_cmx_workorder.

INCLUDE zin_cmx_workorder_top.
INCLUDE zin_cmx_workorder_sel.
INCLUDE zin_cmx_workorder_f01.

START-OF-SELECTION.
  PERFORM f_get_orders.
  PERFORM f_prefetch_data.     "Prefetch JEST, INOB, AUSP, CDHDR
  PERFORM f_process_orders.    "Loop inside routine

END-OF-SELECTION.
  IF gt_output IS NOT INITIAL.
    IF p_test IS INITIAL.
      PERFORM f_send_cmx.
      PERFORM f_send_to_cpi.
    ENDIF.
    PERFORM f_display.
  ELSE.
    WRITE: / 'No matching orders found.'.
  ENDIF.