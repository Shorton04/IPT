" If not intercompany, still perform FX conversion manually
IF ls_data-amount_posting IS INITIAL.
  " Perform FX conversion if currency differs
  IF <fs_result>-waers <> ls_prps-waers.

    DATA(lv_exch_rate) = 0.
    " Get exchange rate from TCURR
    SELECT SINGLE ukurs INTO lv_exch_rate
      FROM tcurr
      WHERE fcurr = @<fs_result>-waers
        AND tcurr = @ls_prps-waers
        AND gdatu = @sy-datum.

    IF sy-subrc = 0 AND lv_exch_rate > 0.
      ls_data-amount_posting = <fs_result>-amount * lv_exch_rate.
      ls_data-waers_posting  = ls_prps-waers.
    ELSE.
      " Default: no rate found, copy as is
      ls_data-amount_posting = <fs_result>-amount.
      ls_data-waers_posting  = <fs_result>-waers.
    ENDIF.
  ELSE.
    " Same currency: no conversion needed
    ls_data-amount_posting = <fs_result>-amount.
    ls_data-waers_posting  = <fs_result>-waers.
  ENDIF.
ENDIF.